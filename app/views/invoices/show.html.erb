<h1>Invoice Show Page</h1>

<h2>Invoice #<%= @invoice.id %></h2>

<p>Status: <%= @invoice.status %></p>
<p>Created at: <%= @invoice.created_at.strftime("%A, %B %d, %Y") %></p>
<p>Customer: <%= @invoice.customer.name %></p>

<h3>Invoice Items</h3>
<ul id="invoice_items">
  <% @invoice.merchant_items(@merchant).each do |item| %>
    <li id="item_<%= item.id %>">
      <%= item.name %>
      <p>Quantity: <%= item.invoice_item(@invoice).quantity %></p>
      <p>Sale Price: <%= item.invoice_item(@invoice).unit_price %></p>
      <%= form_with url: merchant_invoice_item_path(@merchant, item.invoice_item(@invoice)), method: :patch do |f| %>
        <%= f.label :status, "Status" %>
        <%= f.select :status, options_for_select([:pending, :packaged, :shipped], selected: item.invoice_item(@invoice).status) %>
        <%= f.hidden_field :invoice_id, value: @invoice.id %>
        <%= f.submit "Update Item Status"  %>
      <% end %>
    </li>
  <% end %>
</ul>

<div id="total_invoice_revenue">
<p>Total Revenue From This Invoice: $<%= (@invoice.calculate_invoice_revenue / 100.to_f).round(2)%></p>
</div>
